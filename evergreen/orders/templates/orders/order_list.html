{% extends "base_bootstrap.html" %}
{% load static %} 
{% load humanize %} 

{% block hdr %}
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
  <title>Static Example</title>

  <!-- jQuery -->
  <script src="https://code.jquery.com/jquery-3.3.1.slim.min.js" integrity="sha384-q8i/X+965DzO0rT7abK41JStQIAqVgRVzpbzo5smXKp4YfRvH+8abtTE1Pi6jizo" crossorigin="anonymous"></script>

  <!-- XDSoft DateTimePicker -->
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/jquery-datetimepicker/2.5.20/jquery.datetimepicker.min.css" integrity="sha256-DOS9W6NR+NFe1fUhEE0PGKY/fubbUCnOfTje2JMDw3Y=" crossorigin="anonymous" />
  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery-datetimepicker/2.5.20/jquery.datetimepicker.full.min.js" integrity="sha256-FEqEelWI3WouFOo2VWP/uJfs1y8KJ++FLh2Lbqc8SJk=" crossorigin="anonymous"></script>
{% endblock %}


{% block content %}
<h1>Menu</h1>
<p>
{% if meal_list %}
<ul>
  {% for meal in meal_list %}
    <li>
    <form action="{% url 'orders:all' %}" method="get">
    {{ meal.name }} {{ meal.price }}
    <select name="n">
      {% for i in num_list %}
      {% if i == 1 %}
      <option selected="selected">{{i}}</option>
      {% else %}
      <option>{{i}}</option>
      {% endif %}
      {% endfor %}
    </select>
    <button name="m" type="submit" value={{meal.id}}>add to cart</button>

    <div class="column">
      <img src="{% static 'images/dishes/'|add:meal.name|add:'.jpg' %}" alt={{meal.name}}>
    </div>
    </form>
    {{ meal.introdution }}
    </li>
  {% endfor %}
</ul>
{% endif %}

<p>
<p>
{% if err_msg %}
{{err_msg}}
{% elif cart_list %}
<b>Your Cart</b>
  <p>
  {% for name, id, num, sub_price in cart_list %}
  {{name}}: {{sub_price}}
  <form action="{% url 'orders:all' %}" method="get">
  <select name="n">
    {% for i in num_list %}
      {% if i == num %}
      <option selected="selected">{{i}}</option>
      {% else %}
      <option>{{i}}</option>
      {% endif %}
    {% endfor %}
  </select>
  <button name="m" type="submit" value={{id}}>change num</button>
  </form>
  <form action="{% url 'orders:all' %}" method="get">
  <button name="d" type="submit" value={{id}}>delete</button>
  </form>
  {% endfor %}
  <form action="{% url 'orders:order_create' %}" method="get">
  <button name="s" type="submit" value="OK">place order</button>
  </form>
  </p>
  total price: {{ price }}
{% endif %}
</p>

<p>
{% if user.is_authenticated %}
<a href="{% url 'logout' %}?next={% url 'orders:all' %}">Logout</a>
{% else %}
<a href="{% url 'login' %}?next={% url 'orders:all' %}">Login</a>
{% endif %}
| <a href="{% url 'index' %}">Home</a>
| <a href="{% url 'orders:hist' %}">History</a>
</p>
{% endblock %}
